---
layout: post
title: "DDD"
subtitle: '架构-DDD简介'
author: "Kang"
date: 2021-4-6 19:51:07
header-img: "img/post-head-img/arthas.jfif"
catalog: true
tags:
  - 架构
  - DDD
---
### 阅读参考
- [DDD在携程订单实践](https://zhuanlan.zhihu.com/p/620103914)

## 架构
> 分布式架构，本质上就是化整为零，分而治之的思想。领域驱动设计本质上就是加了领域这个中间层，依然是“计算机科学的任何问题都是可以通过增加一个间接的中间层来解决的”。
>
> 多读一些经典的图书，在这个过程中不再追求记住内容，而是重点思考为什么这么设计，重点理解背后的依据。

#### 一、什么是架构

1. 架构师系统中实体与实体之间的关系所进行的描述，是一系列的决策；
2. 架构是现有结构的描述和长远发展的愿景；
3. 架构是对内部的物/信息功能之间的形式元素关系以及周边环境之间关系的定义。


#### 二、什么是架构图

&emsp;&emsp;架构图是为了抽象的表示软件系统的整体轮廓和各个组件之间的相互关系和约束边界，以及软件系统的物理部署和软件系统的演进方向的整体视图。



#### 三、架构图分类

&emsp;&emsp;分类有很多，有一种比较流行的是4+1视图，分别为场景视图、逻辑视图、物理视图、处理流程视图和开发视图。

* 场景视图（使用维度）

描述系统的参与者(使用者)与系统之间的交互，呈现了哪些功能可被使用，反映了系统的最终需求和交互设计。

* 物理视图（部署维度）

用于描述软件到物理硬件的映射关系，反映出**系统的组件**是如何部署到一组机器节点上的，用于指导软件系统的部署实施过程。

- 逻辑视图（组件维度）

用于描述软件功能拆分后的组件关系，呈现了组件的约束和边界，反映系统整体组成与系统如何构建的，通常由UML的组件图和类图表示。

* 处理流程视图（流转维度）

用于描述软件组件之间的通讯时序，数据的输入与输出，反映系统的内部功能流程与数据流转，通常用时序图和流程图表示。

* 开发视图（开发维度）

用于描述当前系统的模块划分和组成，细化到内部包的组成设计，服务于开发人员。



#### 四、什么样的架构图是好的架构图

&emsp;&emsp;好的架构图要能根据受众将需要传递的信息准确的表达出来，所以一个直接标准就是：受众有没有准确的收到想传递的信息。

&emsp;&emsp;从受众角度来说，一个好的架构图是不需要解释的，它应该是自描述的，并且要具备一致性和足够的准确性，能够与代码相呼应。架构是一项复杂的工作，只使用单个图表来表示架构很容易造成莫名其妙的语义混乱。

### 领域设计
![领域设计](https://raw.githubusercontent.com/kangzhihu/images/master/领域设计.png)
领域设计的三个核心问题：  
问题一：这个战略核心域的名字是什么，它的目标是什么？  
问题二：这个战略核心域中包含哪些概念？  
问题三：这个核心域的支撑子域和通用子域是什么？  
&emsp;&emsp;梳理当前的业务域需要明确业务活动的影响范围，比如某个业务动作或者行为是否会触发下一个业务动作，这个动作（领域事件）的输入和输出是什么，是谁（实体）发出的什么动作（命令），触发了这个动作，这些我们都需要梳理清楚。 

下面是一个栗子：  
&emsp;&emsp;当用户下完订单之后，在仓储领域生成对应的货物拣货单，然后系统根据拣货单中商品给不同分区的仓内作业人员生成对应的拣货任务，作业人员根据对应的拣货任务进行货品的拣取，并放入相应的货物容器中。最终将所有订单商品在拣货完成后进行合流，进行校验，最终形成包裹再进行后续的配送流程。
![领域设计](https://raw.githubusercontent.com/kangzhihu/images/master/领域设计-聚合demo.png)  
&emsp;&emsp;那这个栗子中拣货单就是一个聚合根，后续的所有紧密业务关联方和事件形成一个界限上下文(聚合)，都是围绕这个展开作业。  

##### 战略与战术设计说明
![领域-两个层面设计](https://raw.githubusercontent.com/kangzhihu/images/master/领域设计-DDD.png)  
